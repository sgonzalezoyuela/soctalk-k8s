apiVersion: v1
kind: ConfigMap
metadata:
  name: orchestrator-config
  labels:
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/component: worker
data:
  # Database
  SOCTALK_DB_ENABLED: "true"

  # LLM Provider settings
  SOCTALK_LLM_PROVIDER: "anthropic"
  SOCTALK_FAST_MODEL: "claude-3-haiku-20240307"
  SOCTALK_REASONING_MODEL: "claude-sonnet-4-20250514"
  SOCTALK_LLM_TEMPERATURE: "0.1"
  SOCTALK_LLM_MAX_TOKENS: "4096"

  # Polling settings
  SOCTALK_POLLING_INTERVAL: "60"
  SOCTALK_MAX_ALERTS_PER_POLL: "100"
  SOCTALK_BATCH_SIZE: "10"
  SOCTALK_CORRELATION_WINDOW: "300"

  # Thresholds
  SOCTALK_AUTO_CLOSE_THRESHOLD: "0.3"
  SOCTALK_ESCALATION_THRESHOLD: "0.7"
  SOCTALK_CRITICAL_SEVERITY: "12"

  # Integration toggles (can be overridden per overlay)
  WAZUH_ENABLED: "true"
  CORTEX_ENABLED: "true"
  THEHIVE_ENABLED: "true"
  MISP_ENABLED: "true"
  SLACK_ENABLED: "false"

  # Slack webhook notification settings
  SLACK_CHANNEL: ""
  SLACK_NOTIFY_ON_ESCALATION: "true"
  SLACK_NOTIFY_ON_VERDICT: "true"

  # Human-in-the-Loop settings
  SOCTALK_HIL_BACKEND: "cli"
  SOCTALK_HIL_ENABLED: "true"
  SOCTALK_HIL_TIMEOUT: "300"
  SOCTALK_HIL_SLACK_CHANNEL: ""

  # SSL verification (disable for self-signed certs)
  WAZUH_VERIFY_SSL: "false"

  # MCP server paths (inside container)
  WAZUH_MCP_SERVER_PATH: "/opt/mcp-servers/mcp-server-wazuh"
  CORTEX_MCP_SERVER_PATH: "/opt/mcp-servers/mcp-server-cortex"
  THEHIVE_MCP_SERVER_PATH: "/opt/mcp-servers/mcp-server-thehive"
  MISP_MCP_SERVER_PATH: "/opt/mcp-servers/mcp-server-misp"

  # Logging
  SOCTALK_LOG_LEVEL: "INFO"
  SOCTALK_LOG_FORMAT: "json"
  RUST_LOG: "info"
